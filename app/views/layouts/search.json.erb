{
  "results": {
    <%- if @drug_results and @drug_results.count > 0 %>
      "Drugs": {
        "name": "Drugs",
        "results": [
            <% @drug_results.each_with_index do |result, i| %>
            {
              "title": "<%= result.to_s %>",
              "url": "<%= drug_path(result.id) %>",
              "image": "<%= result.picture %>",
              "price": "<%= result.price.present? ? result.price : 'Not Available' %>",
              "description": "<%= result.description %>"
            }
            <%- unless i >= @drug_results.count - 1 and @drug_results.count > 1%>
              ,
            <% end %>
            <% end %>

        ]
      },
    <% end %>
    <%- if @generic_results and @generic_results.count > 0 %>
    "Generics": {
      "name": "Generics",
      "results": [
          <% @generic_results.each_with_index do |result, i| %>
          {
            "title": "<%= result.to_s %>",
            "url": "<%= generic_path(result.id) %>",
            "image": "<%= result.image %>",
            "description": "<%= result.description %>"
          }
          <%- unless i >= @generic_results.count - 1 and @generic_results.count > 1 %>
            ,
          <% end %>
        <% end %>

      ]
    },
    <% end %>
    <%- if @user_results %>
    "Users": {
      "name": "Users",
      "results": [
        <% @user_results.each_with_index do |result, i| %>
        {
          "title": "<%= result.to_s %>",
          "url": "<%= user_path(result.id) %>",
          "image": "<%= result.picture %>",
          "description": "<%= result.profession %>"
        }
        <%- unless i == @user_results.count - 1 %>
      ,
        <% end %>
        <% end %>
      ]
    }
  },
  <% end %>
  "action": {
    "url": "/search?term=<%= @term %>&mode=all",
    "text": "View all results"
  }
}
